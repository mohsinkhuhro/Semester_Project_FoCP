#include <iostream>
#include <fstream>
#include <string>
#include <cstdio>
#include <limits>

using namespace std;
void ChooseMode(string topicName[], string& difficulty, string Topics[100][6]);
void AdminMode(string topicName[], string& difficulty, string Topics[100][6]);
void Addtopic(string topicName[], string& difficulty, string Topics[100][6]);
void RemoveTopic();
void AddMcqs(string topicName[], string& difficulty, string Topics[100][6]);


int main() {
	string topicName[100];
	string Topics[100][6];
	string difficulty;
	string a = "";

	string password = "vishal";
	string Username = " ";
	int mode;
	/*cout << "___welcome to Quiz generator___\n";
	ChooseMode(topicName, difficulty, Topics);*/

	ifstream out("MathHard.txt");
	string line;

	while (getline(out, line)) {
		cout << line << endl;
	}



}
void ChooseMode(string topicName[], string& difficulty, string Topics[100][6]) {
	int x;
	string password = "vishal", Enterpassword;

	while (true) {
		cout << "Select Mode:\n1. Admin\n2. User\n";
		cin >> x;
		if (x == 1) {
			cout << "Enter password: ";
			cin >> Enterpassword;
			if (Enterpassword == password) {
				AdminMode(topicName, difficulty, Topics);

			}
			else {
				cout << "Wrong password!\n";
			}
		}
		else if (x == 2) {
			cout << "Enter Username: ";
			return;
		}
		else {
			cout << "Invalid command!\n";
		}
	}
}


void AdminMode(string topicName[], string& difficulty, string Topics[100][6]) {
	int choose;
	int exit;
	while (true) {
		cout << "\ncontinue ? > enter: 1\nExit Admin mode ? > enter: 2\n";
		cin >> exit;
		if (exit == 2) return;

		cout << "What you want to do?";
		cout << "\n1. Add Topic\n2. Remove Topic\n3. Add MCQs to a Topic\n4. view Topics\n5. Exit Admin Mode\n";
		cin >> choose;
		if (choose == 1) {
			Addtopic(topicName, difficulty, Topics);
		}
		else if (choose == 2) RemoveTopic();

		else if (choose == 3) AddMcqs(topicName, difficulty, Topics);

		else if (choose == 4) {
			cout << "All saved topics are \n\n";
			ifstream outN;
			outN.open("topicNames.txt", ios::in);
			string line;
			int i = 1;
			while (getline(outN, line)) {
				cout << i++ << ". " << line << endl;
			}
			outN.close();

		}
		else if (choose == 5) {
			return;
		}
	}
}
void Addtopic(string topicName[], string& difficulty, string Topics[100][6]) {
	ofstream outN;
	int out = 1, level;
	cout << "Enter: \n1. continue\n2. exit\n ";
	cin >> out;
	if (out == 2) {
		cout << "You Exit!\n";
	}

	for (int i = 0; (i < 100) && out == 1; i++) {
		bool Available = false;
		cin.ignore(numeric_limits<std::streamsize>::max(), '\n');

		cout << "Enter the Topic name: ";
		getline(cin, topicName[i]);
		ifstream out("topicNames.txt");
		string line;

		while (getline(out, line)) {
			if (topicName[i] == line) {
				Available = true;
			}
		}
		out.close();

		ofstream in("topicNames.txt", ios::app);

		if (!Available) { in << topicName[i] << endl; }
		in.close();



		cout << "\nEnter the Difficulty level of Quiz: \n1. Easy\n2. Medium\n3. Hard \n";
		cin >> level;
		cin.ignore(numeric_limits<std::streamsize>::max(), '\n');


		if (level == 1) {
			int exit = 1;
			difficulty = "Easy";
			outN.open(topicName[i] + difficulty + ".txt", ios::app);
			outN << difficulty << endl;
			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;

				q++;
				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');






			}
			outN.close();
		}

		if (level == 2) {
			int exit = 1;
			difficulty = "Medium";
			outN.open(topicName[i] + difficulty + ".txt", ios::app);
			outN << difficulty << endl;
			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;
				q++;

				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');





			}
			outN.close();
		}

		if (level == 3) {
			int exit = 1;
			difficulty = "Hard";
			outN.open(topicName[i] + difficulty + ".txt", ios::app);
			outN << difficulty << endl;
			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;

				q++;
				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');






			}
			outN.close();
		}
	}
}


void RemoveTopic() {
	string Name;
	int confirm;
	cout << "\ncontinue ? > enter: 1\nExit ? > enter: 2\n";
	cin >> confirm;
	if (confirm == 2) return;
	cin.ignore(numeric_limits<std::streamsize>::max(), '\n');

	ifstream outN;
	ofstream in("temp.txt");
	outN.open("topicNames.txt", ios::in);
	string line;
	int i = 1;
	while (getline(outN, line)) {
		cout << i++ << ". " << line << endl;
	}
	outN.close();
	outN.open("topicNames.txt");
	outN.clear();
	outN.seekg(0);
	cout << "\nEnter the topic which you want to remove: ";
	getline(cin, Name);
	int level;
	bool found = false;
	while (getline(outN, line)) {
		if (Name == line) {
			cout << "\nEnter the Difficulty level of Topic: \n1. Easy\n2. Medium\n3. Hard \n4. Whole topic\n";
			cin >> level;
			cin.ignore(numeric_limits<std::streamsize>::max(), '\n');
			if (level == 1) {
				Name += "Easy";
				cout << "Remove " << Name << " ?\n1. Yes\n2. NO\nEnter 1 or 2: ";
				cin >> confirm;
				found = true;
				if (confirm == 1) {
					outN.close();
					remove((Name + ".txt").c_str());

				}
				else {
					return;
				}
			}
			if (level == 2) {
				Name += "Medium";
				cout << "Remove " << Name << " ?\n1. Yes\n2. NO\nEnter 1 or 2: ";
				cin >> confirm;
				found = true;
				if (confirm == 1) {
					outN.close();
					remove((Name + ".txt").c_str());

				}
				else {
					return;
				}
			}
			if (level == 3) {
				Name += "Hard";
				cout << "Remove " << Name << " ?\n1. Yes\n2. NO\nEnter 1 or 2: ";
				cin >> confirm;
				found = true;
				if (confirm == 1) {
					outN.close();
					remove((Name + ".txt").c_str());

				}
				else {
					return;
				}
			}
			if (level == 4) {
				Name += "All";
				cout << "Remove " << Name << " ?\n1. Yes\n2. NO\nEnter 1 or 2: ";
				cin >> confirm;
				found = true;
				if (confirm == 1) {
					outN.close();
					remove((Name + "Easy.txt").c_str());
					remove((Name + "Medium.txt").c_str());
					remove((Name + "Hard.txt").c_str());

				}
				else {
					return;
				}
			}
		}
		else { in << line << endl; } // for removig topic from topicname file

	}
	in.close();
	outN.close();
	remove("topicNames.txt");
	rename("temp.txt", "topicNames.txt");
	if (!found) {
		cout << "Either topic is not included or Spelling is not Correct!\n";
		return RemoveTopic();
	}

}

void AddMcqs(string topicName[], string& difficulty, string Topics[100][6]) {
	int confirm;
	int level;
	bool found = false;
	string Name;

	cout << "\ncontinue ? > enter: 1\nBack to Admin mode ? > enter: 2\n";
	cin >> confirm;
	cin.ignore(numeric_limits<std::streamsize>::max(), '\n');

	if (confirm == 2) return;

	ifstream out("topicNames.txt");
	string line;

	while (getline(out, line)) {
		cout << line << endl;
	}

	cout << "Enter topic: ";
	getline(cin, Name);

	out.close();
	out.open("topicNames.txt");

	out.clear();
	out.seekg(0);


	while (getline(out, line)) {
		if (line == Name) found = true;
	}

	if (!found) {
		cout << "Either topic is not included or Spelling is not Correct!\n";
		return AddMcqs(topicName, difficulty, Topics);
	}
	else {

		ofstream outN;

		cout << "Enter the Difficulty level of topic: \n1. Easy\n2. Medium\n3. Hard \n";
		cin >> level;
		cin.ignore(numeric_limits<std::streamsize>::max(), '\n');


		if (level == 1) {
			int exit = 1;
			difficulty = "Easy";
			outN.open(Name + difficulty + ".txt", ios::app);


			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;

				q++;
				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');






			}
			outN.close();
		}

		else if (level == 2) {
			int exit = 1;
			difficulty = "Medium";
			outN.open(Name + difficulty + ".txt", ios::app);

			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;
				q++;

				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');





			}
			outN.close();
		}

		else if (level == 3) {
			int exit = 1;
			difficulty = "Hard";
			outN.open(Name + difficulty + ".txt", ios::app);

			int q = 0;

			while (q < 100 && exit == 1) {

				cout << "Enter question: ";
				getline(cin, Topics[q][0]);

				cout << "Option A: ";
				getline(cin, Topics[q][1]);

				cout << "Option B: ";
				getline(cin, Topics[q][2]);

				cout << "Option C: ";
				getline(cin, Topics[q][3]);

				cout << "Option D: ";
				getline(cin, Topics[q][4]);

				cout << "Correct option: ";
				getline(cin, Topics[q][5]);

				// Write all to file
				outN << "Q: " << Topics[q][0] << endl;
				outN << "A) " << Topics[q][1] << endl;
				outN << "B) " << Topics[q][2] << endl;
				outN << "C) " << Topics[q][3] << endl;
				outN << "D) " << Topics[q][4] << endl;
				outN << "Correct: " << Topics[q][5] << endl;
				outN << "-----------------" << endl;

				q++;
				cout << "\nEnter: \n1. continue\n2. exit\n";
				cin >> exit;
				if (exit == 2) break;
				cin.ignore(numeric_limits<std::streamsize>::max(), '\n');






			}
			outN.close();
		}

		else {
			cout << "Invalid command!\n";

			return;
		}
	}
}



